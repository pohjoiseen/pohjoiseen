@using Holvi.Models
@model PostPickerViewModel

<div class="content-header">
     <label for="@Model.ComponentId-post-search-input" style="text-wrap-mode: nowrap; margin-right: 5px;">Search for posts:</label>
     <input type="text" id="@Model.ComponentId-post-search-input" class="input-block picture-set-search-input" value="@Model.PostSearchQuery" hx-get hx-target="#@Model.ComponentId"
            hx-trigger="keyup changed delay:500ms" hx-controller="Posts" hx-action="Picker" hx-route-componentId="@Model.ComponentId"
            hx-route-limit="@Model.Limit" hx-route-offset="0" hx-vals='js:{"postSearch":this.value}'/>
</div>

<div class="content-list" data-remember-state="@Model.ComponentId-offset@(Model.Offset)">
     @foreach (var post in Model.Posts)
     {
          <koti-content-item kind="post" id="@post.Id" src="@post.TitlePicture?.DetailsUrl" name="@post.Date.ToString("yyyy-MM-dd")-@post.Name" title="@post.Title" 
                             height="@Picture.ThumbnailSize" width="@Math.Floor(post.TitlePicture?.Width * 1.0 / post.TitlePicture?.Height * Picture.ThumbnailSize ?? 0)"
                             edit-url="@Url.ActionLink("Edit", "Posts", new { id = post.Id })"></koti-content-item>
     }
</div>

<partial name="_Pagination" model="@(new PaginatorViewModel { Data = Model, HxTarget = "#" + Model.ComponentId,
                                        BaseUrl = Url.ActionLink("Picker", "Posts", new { componentId = Model.ComponentId, postSearch = Model.PostSearchQuery })!})" />

